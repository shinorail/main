<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ›ãƒ¼ãƒ  - ç¯ ãƒäº•ä¹—å‹™åŒº</title>

<link rel="stylesheet" href="style.css">
<link rel="alternate" hreflang="ja" href="index.html">
<link rel="alternate" hreflang="en" href="index.html?lang=en">
<meta name="theme-color" content="#004da0">

<style>
.install-btn{
  background:#004da0;color:#fff;padding:12px 18px;border-radius:6px;
  text-align:center;font-weight:bold;cursor:pointer;margin:20px 0;
}
.install-btn.hidden{display:none}

.modal{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,.6);display:none;
  justify-content:center;align-items:center;z-index:3000
}
.modal-content{
  background:#fff;padding:25px;border-radius:10px;
  max-width:360px;width:85%;text-align:left;position:relative
}
.modal-close{
  position:absolute;top:8px;right:12px;cursor:pointer;font-size:20px
}
.lang-btn{
  position:fixed;top:15px;right:15px;
  background:#eee;padding:6px 10px;border-radius:5px;
  cursor:pointer;font-size:13px;z-index:2000
}
</style>
</head>

<body>

<header></header>
<nav></nav>

<div class="lang-btn" onclick="toggleLang()">English</div>

<div class="container">

<div id="install-btn" class="install-btn hidden">
ã‚¢ãƒ—ãƒªã¨ã—ã¦åˆ©ç”¨ã™ã‚‹
</div>

<section>
<p>ã‚ˆã†ã“ãã€ç¯ ãƒäº•ä¹—å‹™åŒºã®å…¬å¼ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸ã€‚</p>
</section>

<ul id="top-news-list"></ul>

</div>

<!-- ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ -->
<div id="survey-toggle" class="install-btn" onclick="toggleSurvey()">ğŸ“© ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</div>

<div id="survey-container" class="modal">
<div class="modal-content">
<span class="modal-close" onclick="toggleSurvey()">Ã—</span>

<form id="survey-form">
<p>æº€è¶³åº¦ï¼ˆ1ã€œ5ï¼‰</p>
<div>
<label><input type="radio" name="s-rate" value="1">1</label>
<label><input type="radio" name="s-rate" value="2">2</label>
<label><input type="radio" name="s-rate" value="3" checked>3</label>
<label><input type="radio" name="s-rate" value="4">4</label>
<label><input type="radio" name="s-rate" value="5">5</label>
</div>

<textarea id="s-msg" rows="3" placeholder="ã”è‡ªç”±ã«"></textarea>
<button id="s-btn" type="submit">é€ä¿¡</button>
</form>

<div id="s-thanks" style="display:none">
<h3>ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ</h3>
<p>ã”å”åŠ›æ„Ÿè¬ã„ãŸã—ã¾ã™ã€‚</p>
</div>
</div>
</div>

<!-- ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¡ˆå†… -->
<div id="install-modal" class="modal">
<div class="modal-content">
<span class="modal-close" onclick="closeInstall()">Ã—</span>
<h3>ã‚¢ãƒ—ãƒªã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™</h3>
<p>
ã€Androidã€‘<br>
Chromeå³ä¸Šã€Œï¸™ã€â†’ ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<br><br>
ã€PCã€‘<br>
ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼å³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¢ã‚¤ã‚³ãƒ³<br><br>
ã€iOSã€‘<br>
å…±æœ‰ â†’ ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ 
</p>
</div>
</div>

<footer></footer>

<script src="menu.js"></script>

<script>
const scriptUrl="https://script.google.com/macros/s/AKfycbwbUTBxVeTkRlAJ1dnBlgcmpGaWI9B0SeMwkwKSwAJYjRDAtVcX67QwA5FcNGaJE9Cq/exec";

let deferredPrompt=null;

/* PWA */
window.addEventListener("beforeinstallprompt",e=>{
 e.preventDefault();
 deferredPrompt=e;
 document.getElementById("install-btn").classList.remove("hidden");
});

document.getElementById("install-btn").onclick=()=>{
 document.getElementById("install-modal").style.display="flex";
};

function closeInstall(){
 document.getElementById("install-modal").style.display="none";
}

/* ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ */
function toggleSurvey(){
 if(!navigator.onLine)return;
 const m=document.getElementById("survey-container");
 m.style.display=m.style.display==="flex"?"none":"flex";
}

document.getElementById("survey-form").addEventListener("submit",async e=>{
 e.preventDefault();
 const btn=document.getElementById("s-btn");
 btn.disabled=true;

 await fetch(scriptUrl,{method:"POST",body:JSON.stringify({
  rating:document.querySelector('[name="s-rate"]:checked').value,
  message:document.getElementById("s-msg").value
 })});

 document.getElementById("survey-form").style.display="none";
 document.getElementById("s-thanks").style.display="block";

 setTimeout(()=>{
  document.getElementById("survey-container").style.display="none";
  document.getElementById("install-modal").style.display="flex";
 },1500);
});

/* ç¿»è¨³ */
function toggleLang(){
 const u=new URL(location.href);
 if(u.searchParams.get("lang")==="en"){
  u.searchParams.delete("lang");
 }else{
  u.searchParams.set("lang","en");
 }
 location.href=u.toString();
}

if(new URLSearchParams(location.search).get("lang")==="en"){
 const s=document.createElement("script");
 s.src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit";
 document.body.appendChild(s);
 window.googleTranslateElementInit=()=>{
  new google.translate.TranslateElement({pageLanguage:"ja"},document.body);
 };
}

/* ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ */
if(!navigator.onLine){
 document.getElementById("survey-toggle").style.display="none";
}

/* ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ */
if(window.matchMedia('(display-mode: standalone)').matches){
 document.getElementById("install-btn").style.display="none";
}
</script>

</body>
</html>
