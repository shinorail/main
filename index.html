<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ›ãƒ¼ãƒ  - ç¯ ãƒäº•ä¹—å‹™åŒº</title>

<link rel="stylesheet" href="style.css">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#004da0">

<style>
/* ===== indexå°‚ç”¨UIï¼ˆå…ƒãƒ‡ã‚¶ã‚¤ãƒ³ä¿æŒï¼‰ ===== */
.omikuji-box {
  background: linear-gradient(135deg, #fff5f5 0%, #fff0f0 100%);
  border: 2px solid #d32f2f;
  padding: 20px;
  border-radius: 10px;
  margin-bottom: 30px;
  text-align: center;
}
.omikuji-box h3 { color:#d32f2f; margin-top:0; }
.btn-omikuji {
  background:#d32f2f; color:#fff;
  padding:10px 20px;
  border-radius:5px;
  text-decoration:none;
  font-weight:bold;
}
.sns-info {
  background:#e3f2fd;
  padding:15px;
  border-radius:5px;
  border-left:5px solid #2196f3;
}
.link-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
  margin-top:30px;
}
.link-card {
  background:#f0f0f0;
  padding:15px;
  text-align:center;
  text-decoration:none;
  color:#004da0;
  font-weight:bold;
  border-radius:5px;
  border:1px solid #ddd;
}

/* ===== ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ ===== */
.survey-toggle {
  position:fixed;
  bottom:20px; right:20px;
  background:#004da0; color:#fff;
  padding:12px 20px;
  border-radius:30px;
  font-weight:bold;
  cursor:pointer;
  z-index:1500;
}
.survey-popup {
  position:fixed;
  bottom:80px; right:20px;
  width:300px;
  background:#fff;
  border-radius:10px;
  box-shadow:0 5px 20px rgba(0,0,0,.2);
  display:none;
  flex-direction:column;
  z-index:1500;
}
.survey-header {
  background:#004da0; color:#fff;
  padding:10px 15px;
  display:flex;
  justify-content:space-between;
}
.s-rating { display:flex; }
.s-rating input { display:none; }
.s-rating label {
  flex:1; margin:2px;
  background:#eee;
  text-align:center;
  padding:8px 0;
  border-radius:4px;
  cursor:pointer;
}
.s-rating input:checked + label {
  background:#004da0; color:#fff;
}

/* ===== PWAèª˜è‡´ï¼ˆä¸­å¤®ï¼‰ ===== */
#pwa-after {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  z-index:4000;
  justify-content:center;
  align-items:center;
}
#pwa-box {
  background:#fff;
  width:90%;
  max-width:360px;
  padding:24px;
  border-radius:12px;
  text-align:center;
  position:relative;
}
#pwa-box button.close {
  position:absolute;
  top:8px; right:10px;
  border:none;
  background:none;
  font-size:20px;
  cursor:pointer;
}
</style>
</head>

<body>

<header></header>
<nav></nav>

<div class="container">
  <section class="omikuji-box">
    <h3>ã€2å‘¨å¹´è¨˜å¿µã€‘ãŠæ­£æœˆãŠã¿ãã˜</h3>
    <p>ç¾åœ¨å…¬é–‹ä¸­ï¼ˆ1æœˆ31æ—¥ã¾ã§ï¼‰</p>
    <a href="https://shinorail.github.io/shinonoi-2026/" class="btn-omikuji">ç‰¹è¨­ã‚µã‚¤ãƒˆã¯ã“ã¡ã‚‰</a>
  </section>

  <p>ã‚ˆã†ã“ãã€ç¯ ãƒäº•ä¹—å‹™åŒºã®å…¬å¼ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸ã€‚</p>

  <section class="sns-info">
    <strong>Xï¼ˆæ—§Twitterï¼‰</strong><br>
    <a href="https://x.com/Shino_Rail">@Shino_Rail</a>
  </section>

  <div class="link-grid">
    <a href="mission.html" class="link-card">æ´»å‹•ç†å¿µ</a>
    <a href="history.html" class="link-card">æ²¿é©</a>
    <a href="news.html" class="link-card">ãŠçŸ¥ã‚‰ã›</a>
  </div>
</div>

<!-- ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ -->
<div id="survey-toggle" class="survey-toggle">ğŸ“© ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆå”åŠ›</div>

<div id="survey" class="survey-popup">
  <div class="survey-header">
    <span>é–²è¦§è€…ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</span>
    <button onclick="toggleSurvey()">Ã—</button>
  </div>
  <form id="survey-form" style="padding:15px">
    <div class="s-rating">
      <input type="radio" name="rate" id="r1" value="1"><label for="r1">1</label>
      <input type="radio" name="rate" id="r2" value="2"><label for="r2">2</label>
      <input type="radio" name="rate" id="r3" value="3" checked><label for="r3">3</label>
      <input type="radio" name="rate" id="r4" value="4"><label for="r4">4</label>
      <input type="radio" name="rate" id="r5" value="5"><label for="r5">5</label>
    </div>
    <textarea id="msg" rows="3" style="width:100%;margin-top:10px"></textarea>
    <button type="submit" style="width:100%;margin-top:10px">é€ä¿¡</button>
  </form>
  <div id="thanks" style="display:none;padding:20px;text-align:center">
    <strong>ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ</strong>
  </div>
</div>

<!-- PWAèª˜è‡´ -->
<div id="pwa-after">
  <div id="pwa-box">
    <button class="close">Ã—</button>
    <h3>ã‚¢ãƒ—ãƒªã¨ã—ã¦ä½¿ã„ã¾ã›ã‚“ã‹ï¼Ÿ</h3>
    <p>ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã§ãã¾ã™</p>
    <button id="pwa-install">ã‚¢ãƒ—ãƒªã‚’åˆ©ç”¨ã™ã‚‹</button>
  </div>
</div>

<footer></footer>

<script src="menu.js"></script>

<script>
/* ===== PWA åŸºæœ¬ ===== */
let deferredPrompt = null;

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js');
}

window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  deferredPrompt = e;
});

function isInstalled() {
  return window.matchMedia('(display-mode: standalone)').matches
    || window.navigator.standalone === true;
}

/* ===== ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ ===== */
const survey = document.getElementById('survey');
document.getElementById('survey-toggle').onclick = toggleSurvey;

function toggleSurvey() {
  if (!navigator.onLine) return;
  survey.style.display = survey.style.display === 'flex' ? 'none' : 'flex';
}

document.getElementById('survey-form').onsubmit = e => {
  e.preventDefault();
  document.getElementById('survey-form').style.display = 'none';
  document.getElementById('thanks').style.display = 'block';

  setTimeout(() => {
    survey.style.display = 'none';
    if (!isInstalled() && deferredPrompt) {
      document.getElementById('pwa-after').style.display = 'flex';
    }
  }, 1000);
};

/* ===== PWAèª˜è‡´ ===== */
document.querySelector('#pwa-box .close').onclick = () => {
  document.getElementById('pwa-after').style.display = 'none';
};

document.getElementById('pwa-install').onclick = async () => {
  if (!deferredPrompt) return;
  deferredPrompt.prompt();
  await deferredPrompt.userChoice;
  deferredPrompt = null;
};
</script>

</body>
</html>
