<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒã‚¤ãƒšãƒ¼ã‚¸ | ç¯ ãƒäº•ã‚¿ã‚¤ãƒ ã‚º</title>
    <style>
        body { background-color: #f4f4f4; font-family: "serif"; margin: 0; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: #fff; padding: 30px; border: 1px solid #000; box-shadow: 5px 5px 0px #ccc; }
        .info-box { border: 1px dashed #999; padding: 15px; margin: 20px 0; }
        .birthday-msg { display: none; background: #fff0f0; border: 2px solid #ff0000; padding: 15px; color: #d32f2f; font-weight: bold; text-align: center; margin-bottom: 20px; }
        .btn { display: inline-block; padding: 10px 20px; background: #004da0; color: #fff; text-decoration: none; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="border-bottom: 2px solid #000;">ãƒã‚¤ãƒšãƒ¼ã‚¸</h1>
        
        <div id="birthdayMessage" class="birthday-msg">
            ğŸ‚ ãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼<br>ä»Šæœˆã¯ç¯ ãƒäº•ã‚¿ã‚¤ãƒ ã‚ºã‹ã‚‰ã•ã•ã‚„ã‹ãªãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ¬ã‚¿ãƒ¼ã‚’ãŠé€ã‚Šã—ã¾ã™ã€‚
        </div>

        <div class="info-box">
            <p><strong>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</strong> <span id="userEmail">å–å¾—ä¸­...</span></p>
            <p><strong>ç”Ÿå¹´æœˆæ—¥:</strong> <span id="userBirthday">å–å¾—ä¸­...</span></p>
        </div>

        <button onclick="logout()" class="btn" style="background:#666;">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        <a href="train-news.html" class="btn">æ–°èãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</a>
    </div>

    <script>
    window.onload = async function() {
        const email = localStorage.getItem("userEmail");
        if (!email) {
            alert("ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™");
            window.location.href = "login.html";
            return;
        }
        document.getElementById("userEmail").innerText = email;

        const url = "https://script.google.com/macros/s/AKfycbzuta6xRTHYX7wHtYJ54O_QhJzXRwxGOBC8j7zjIwbE-mK23Afi_M5JJAIqYNo6OO79kQ/exec";
        
        // GASã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
        try {
            const response = await fetch(`${url}?action=getUserInfo&email=${email}`);
            const data = await response.json();

            if (data.status === "success") {
                const birthday = new Date(data.birthday);
                document.getElementById("userBirthday").innerText = data.birthday;

                // èª•ç”Ÿæœˆã®åˆ¤å®š
                const today = new Date();
                if (birthday.getMonth() === today.getMonth()) {
                    document.getElementById("birthdayMessage").style.display = "block";
                }
            }
        } catch (e) {
            console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼", e);
        }
    };

    function logout() {
        localStorage.removeItem("userEmail");
        window.location.href = "login.html";
    }
    </script>
</body>
</html>
