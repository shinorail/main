<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train-News 一覧 - 篠ノ井乗務区</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .news-item {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            background: #fff;
            text-decoration: none;
            color: #333;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
        }
        .news-item:hover {
            border-color: #004da0;
            background: #f0f7ff;
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .news-meta {
            display: flex;
            align-items: center;
            font-size: 0.85em;
            color: #666;
            margin-bottom: 10px;
        }
        .news-no {
            background: #004da0;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            margin-right: 10px;
            font-weight: bold;
        }
        .news-title {
            display: block;
            font-weight: bold;
            font-size: 1.1em;
            color: #004da0;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        .news-summary {
            font-size: 0.9em;
            line-height: 1.5;
            color: #444;
            flex-grow: 1;
        }
        #loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }
    </style>
</head>
<body>

<header></header>
<nav></nav>

<div class="container">
    <h2>Train-News（サイト内新聞）</h2>
    <p>篠ノ井乗務区が発行する広報紙や、号外ニュースの一覧です。</p>
    
    <div id="loading">新聞データを連結中...</div>
    <div id="news-list" class="news-grid"></div>
</div>

<footer></footer>

<script src="menu.js"></script>
<script>
    // 統合したGASのURL
    const scriptUrl = "https://script.google.com/macros/s/AKfycbwbUTBxVeTkRlAJ1dnBlgcmpGaWI9B0SeMwkwKSwAJYjRDAtVcX67QwA5FcNGaJE9Cq/exec";

    async function loadTrainNews() {
        try {
            // パラメータ ?sheet=新聞 を付けて呼び出し
            const response = await fetch(scriptUrl + "?sheet=新聞");
            const data = await response.json();
            
            document.getElementById('loading').style.display = 'none';
            const list = document.getElementById('news-list');

            // 新しい順に表示（reverse）
            data.reverse().forEach(item => {
                const a = document.createElement('a');
                a.className = 'news-item';
                a.href = item.URL; // PDFまたはHTMLへのリンク
                
                a.innerHTML = `
                    <div class="news-meta">
                        <span class="news-no">${item.号数}</span>
                        <span class="news-date">${item.日付}</span>
                    </div>
                    <span class="news-title">${item.タイトル}</span>
                    <p class="news-summary">${item.概要}</p>
                `;
                list.appendChild(a);
            });
        } catch (e) {
            document.getElementById('loading').innerHTML = "<p>新聞データの取得に失敗しました。<br>スプレッドシートの「新聞」シートを確認してください。</p>";
        }
    }

    loadTrainNews();
</script>

</body>
</html>
