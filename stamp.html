<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>乗車印帳 - 篠ノ井乗務区</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { background: #fdfaf5; }
        .stamp-container { max-width: 600px; margin: 20px auto; padding: 20px; background: #fff; border: 2px solid #d4c4a8; border-radius: 8px; display: none; text-align: center; }
        #terms-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:10000; display:flex; justify-content:center; align-items:center; }
        .terms-box { background:#fff; padding:20px; border-radius:10px; max-width:400px; text-align:center; }
        .stamp-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; }
        .stamp-slot { aspect-ratio: 1/1; border: 2px dashed #ccc; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .stamp-slot.active { border: 2px solid #e63946; }
        .ink-stamp { border: 3px solid #e63946; border-radius: 50%; width: 70%; height: 70%; display: flex; align-items: center; justify-content: center; color: #e63946; font-weight: bold; opacity: 0; transform: rotate(-15deg); }
        .active .ink-stamp { opacity: 0.7; }
        .completion-msg { border: 2px solid #d4af37; background: #000; padding: 20px; margin-top: 20px; box-shadow: 0 0 15px rgba(212,175,55,0.3); }
    </style>
</head>
<body>
<header></header><nav></nav>
<div id="terms-overlay">
    <div class="terms-box">
        <h3>デジタル乗車印帳 利用規約</h3>
        <p style="font-size:0.8em; text-align:left;">サイト内を巡ると自動でスタンプが押されます。データはブラウザに保存されます。</p>
        <button onclick="agree()" style="background:#e63946; color:#fff; border:none; padding:10px 20px; cursor:pointer;">同意して開始</button>
    </div>
</div>
<div class="stamp-container" id="main-content">
    <h1>デジタル乗車印帳</h1>
    <div class="stamp-grid">
        <div class="stamp-slot" id="slot-index"><div class="ink-stamp">篠ノ井</div></div>
        <div class="stamp-slot" id="slot-news"><div class="ink-stamp">長野</div></div>
        <div class="stamp-slot" id="slot-train-news"><div class="ink-stamp">松本</div></div>
        <div class="stamp-slot" id="slot-renkei"><div class="ink-stamp">踏破</div></div>
    </div>
    <div id="completion-area" class="completion-msg" style="display:none;">
        <p style="color:#d4af37; font-family:serif; font-size:0.8em; letter-spacing:2px;">SPECIAL PRIVILEGE</p>
        <h2 style="color:#d4af37; font-family:serif;">全区間踏破 達成</h2>
        <a href="secret.html" style="display:inline-block; margin-top:15px; padding:10px 25px; border:1px solid #d4af37; color:#d4af37; text-decoration:none; font-family:serif;">特別室へ入室する</a>
    </div>
</div>
<script src="menu.js"></script>
<script>
    function agree() { localStorage.setItem('stamp_agreed', 'true'); location.reload(); }
    if(localStorage.getItem('stamp_agreed') === 'true') {
        document.getElementById('terms-overlay').style.display='none';
        document.getElementById('main-content').style.display='block';
        const history = JSON.parse(localStorage.getItem('stampHistory') || '{}');
        const ids = ['index', 'news', 'train-news', 'renkei'];
        let count = 0;
        ids.forEach(id => { if(history[id]) { document.getElementById('slot-'+id).classList.add('active'); count++; } });
        if(count >= 4) document.getElementById('completion-area').style.display='block';
    }
</script>
</body>
</html>
